[[{"i":"welcome-to-yabob-documentation","l":"Welcome to YABOB Documentation!","p":["To get started, invite YABOB to your discord server by following the guide."]}],[{"l":"Invite Procedure","p":["This invite procedure applies to YABOB v4.3 and above."]},{"l":"Video Guide"},{"l":"Text Guide","p":["Create a discord server. All the folling steps will assume that you are the owner of this server.","Use the invite link to invite YABOB to your server","If other roles exist on your server, YABOB will send you a direct message asking you to give it the highest role. The message will look like:","Go to Server Settings \\to Roles and drag the YABOB role all the way to the top. Save the setting.","Now YABOB will send you another direct message saying that it has gotten the highest role and is initializing for your server.","YABOB will now ask you to set up the access level roles for your server. If you don't have any roles in the server, you can use either the [Create New Roles] or [Create New Roles (@everyone is student)] option for quick setup. You can see the full documentation here to see what each option does.","After you make a choice, YABOB will save your settings and update the message:","Now you are ready to create queues! In your server, use /queue add to create some new queues. After the command finishes, a new role is created for each new queue.","Give yourself some of the the newly created queue roles (for example if the queue is called \"Class A\", the role is also called \"Class A\") and use /start to open these queues.","(Optional) You can easily batch create office hour voice channels with /create_offices. YABOB will configure the voice channel permissions for you based on the roles you selected in step 4.","(Optional) You can further configure YABOB settings with the /settings command. Learn more about YABOB settings here.","(Optional) When you are no longer using a server for your office hours, simply delete the server itself or kick YABOB from that server."]}],[{"i":"how-to-host--join-office-hours-with-yabob","l":"How To Host & Join Office Hours with YABOB","p":["Updated Jan.6, 2024","This page assumes that you have already invited YABOB to your server and created at least 1 queue. If not, please refer to the Invite Procedure Page to get started."]},{"l":"Access Level Roles","p":["If you are not familiar with Discord roles, check out this official explanation.","YABOB interacts with 3 roles on your server.","Members with total control over YABOB. The default bot admin role created during server initialization is:","Members that can host office hours and open queues. The default staff role created during server initialization is:","Members that can join queues and get help. The default student role created during server initialization is:","These roles are treated as access level roles and used to restrict members of your server from accessing certain commands. For example, /clear_all could be a disastrous command if everyone has access to it.","To get started, we recommend:","Giving to the administration team of the server. This could be the professor(s) of a course, the managers of a tutoring service etc.","Giving to the teaching assistants / tutors / staff members.","Giving to everyone else or members that have verified their identity. (Example: Some servers require students to have a valid school email.)"]},{"l":"Office Hour Protocol","p":["Before starting office hours, staff members need to be given queue roles of the queues they are approved to help for. These roles are automatically created when you use /queue add queue_name and have the same name as the queue category. For example, if your queue is called \"Class A\", then the queue role is also called \"Class A\".","A typical office hour session goes like this:","opens queues with /start and joins a voice channel.","joins the queues they need help with by pressing the [Join] button or using the /enqueue command.","will receive a direct message from YABOB saying that a student has joined a queue.","uses /next to dequeue a student.","who was dequeued receives a direct message from YABOB saying that it's their turn to join the office hour voice channel. This message also contains a link to that voice channel.","joins the voice channel and get help.","leaves the voice channel after they are done receiving help.","uses /stop to close the queues.","If you are not familiar with discord voice channel features, check out this official guide."]},{"i":"advanced-usage-staff--bot-admin","l":"Advanced Usage (Staff & Bot Admin)","p":["In addition to the protocol above, there are also more in-depth commands you can use to fully control your office hours:","You can use /pause and /resume to temporarily stop accepting new students.","You can ask students to submit a short description of what they need help with when they join the queue. This can be done with /prompt_help_topic on or inside the settings menu.","You can track staff member's attendance and conduct analytics with the Google Sheets Logging Extension.","You can require students to be verified through some method before they are allowed to join queues. For example, you can invite another email verification bot that automatically gives new members the access level role when they verify their email.","Let YABOB automatically send a message to students after they leave the voice channel with the after session message setting."]},{"i":"advanced-usage-students","l":"Advanced Usage (Students)","p":["Although the voice channels are hidden from you, the voice channel status is still visible inside #queue channels. If a staff member is busy helping students, you will see that they are \"Busy in Voice Channel Name\"","You can see when there will be more office hour sessions directly inside ##queue channels with the \"Upcoming Sessions\" embed from the Google Calendar Extension.","(If completed the setup) You can use /when_next to ask YABOB to fetch from the linked google calendar and list upcoming office hour sessions.","Look for the cat in queues! It's very mysterious and only has <10% chance of showing up.","See what YABOB is doing by checking its discord presence!","There are many more commands and settings you can use beyond what we have described here in the Built-in Commands and Extension Commands page. Happy hosting office hours!"]}],[{"l":"Built-in Commands","p":["Updated on Sep.24 2023","This page covers all the commands of base YABOB. For extension commands, see the extension commands page.","They have been moved under /settings"]},{"i":"format","l":":icon-note: **Format**","p":["Title: Command name.","Matches the exact command name in discord","Options: Possible arguments of this command.","Arguments with a question mark are optional","Access Level: The lowest required access level role to access the command.","The roles are ordered (From high to low): > > > Everyone","Example: If the access level specifies , then bot admins and staff also has access to this command. But if the access level is , then staff and students do not have access.","If you have the administrator permission of a server, you are not required to have any access level roles.","Throws: Possible errors that YABOB can throw.","These errors are expected to happen, and YABOB will reply back to the user with the error. YABOB will not modify any internal states if it rejects the command."]},{"l":"Command List"},{"i":"enqueue","l":"/enqueue","p":["Adds the user to the back of the queue.","queue_name?- specifies which queue to join. If not specified, the user will be enqueued to the queue where they used the command if a #queue channel exists in its parent category.","Student and above.","CommandParseError","If the specified queue_name argument is not a valid queue channel.","If the command is used without specifying queue_name, and it's used in a channel with no parent category or the category does not have a #queue channel.","If the user does not have the student role.","QueueError","If the student is already in the queue.","If the queue is not open (ie. if the queue is closed or paused)"]},{"i":"leave","l":"/leave","p":["Removes the user from a queue. If the queue_name argument is not specified, the user will be removed from the queue where they used the command if a #queue channel exists in its parent category.","queue_name?- specifies which queue to leave from.","CommandParseError","If the specified queue_name argument is not a valid queue channel.","If the command is used in a channel with no parent category or the category does not have a #queue channel.","QueueError","If the student is not in the queue."]},{"i":"list_helpers","l":"/list_helpers","p":["Lists all the helpers that are currently helping","Nothing."]},{"i":"start","l":"/start","p":["Opens all the queues that the user has a role for and start helping students.","mute_notif?- If true, opening the queue will NOT notify the students who have signed up for notifications and the notification group will not be cleared. Defaults to false.","CommandParseError","If the user does not have the Staff or Bot Admin role.","ServerError","If the helper is already helping.","If the helper does not have any class roles."]},{"i":"stop","l":"/stop","p":["Closes the office-hour queues and stop students from entering the queue.","Students that were in the queue before closing will remain in the queue for the next office hour session.","If Queue Auto Clear is enabled when the queue is closed, a timer will be started if there are students remaining in the queue.","CommandParseError","If the user does not have the Staff or Bot Admin role.","ServerError","If the helper is not currently helping."]},{"i":"next","l":"/next","p":["Invites the student at the front of the queue to the helper's voice channel.","queue_name?- Specifies which queue to dequeue from. If not specified, dequeues the student that has been waiting the longest out of all the queues that the helper has a role for.","user?- Specifies which student to dequeue. If specified, YABOB will ignore queue order and search for this student. If queue_name is also specified, YABOB will search in that queue for this student.","CommandParseError","If the user does not have the Staff or Bot Admin role.","If the specified queue_name is not a valid queue category","ServerError","If there's no student to dequeue.","If the specified user is not found in any of the queues.","If the specified user is not found in the specified queue_name."]},{"i":"announce","l":"/announce","p":["Sends a message to all of the students in all the queues that the helper is approved to help for.","message- Required. The announcement message content.","queue_name?- Which queue to send the announcement to. If not specified, YABOB will send the message to all the queues that the helper has a role of.","CommandParseError","If the user does not have the Staff or Bot Admin role.","If the specified queue category does not have a #queue channel.","If the announcement is longer than 4096 characters. This limit comes from discord's API.","If the specified queue_name is not a valid queue category."]},{"i":"pause","l":"/pause","p":["Marks the user as a helper who has temporarily stopped accepting new students. When new students join the queue, this helper will not be notified.","CommandParseError","If the user does not have the Staff or Bot Admin role.","ServerError","If the user is not currently helping.","If the user is already a paused helper.","If all the helpers of the same queue have used /pause, this queue will enter the PAUSED state that will stop students from joining the queue. Helpers of a PAUSED queue can still dequeue students. As of v4.3, ALL helpers of the same queue must use /pause to make the queue PAUSED.","The queue embed of a PAUSED queue will have a yellow embed instead of an aqua embed."]},{"i":"resume","l":"/resume","p":["Lets a helper exit the paused state. They will become active if the command succeeds.","CommandParseError","If the user does not have the Staff or Bot Admin role.","ServerError","If the user is not currently helping","If the user is not a paused helper"]},{"i":"clear","l":"/clear","p":["Clears the specified queue.","queue_name- Required parameter. Specifies which queue to clear.","CommandParseError","If the user does not have the Staff or Bot Admin role.","If the specified queue category does not have a #queue channel.","ServerError","If there is no student in the specified queues"]},{"i":"clear_all","l":"/clear_all","p":["Clears all the queues on this server.","CommandParseError","If the user does not have the Bot Admin role.","If the specified queue category does not have a #queue channel.","ServerError","If there is no student in any of the queues"]},{"i":"cleanup_queue","l":"/cleanup_queue","p":["Debug feature. If the embeds in a queue were accidentally deleted, this command will ask the queue to perform a clean render.","queue_name- Required Parameter. Which queue to clean up.","CommandParseError","If the user does not have the Bot Admin role.","If the specified queue category does not have a #queue channel."]},{"i":"cleanup_all","l":"/cleanup_all","p":["Same as /cleanup_queue but affects all the queues.","CommandParseError","If the user does not have the Bot Admin role.","If the specified queue category does not have a #queue channel."]},{"i":"cleanup_help_channels","l":"/cleanup_help_channels","p":["Debug feature. If the embeds in a the help channels were accidentally deleted, this command will re-send all the help channel embeds.","CommandParseError","If the user does not have the Bot Admin role."]},{"i":"queue","l":"/queue","p":["This command has 2 sub-commands.","/queue add queue_name","Creates a new category with the name entered in queue_name and creates the #queue and #chat text channels within it.","/queue remove queue_name","Deletes an existing category with the name entered in queue_name and all the channels within it.","queue_name- Required Parameter","For /queue add, this is a string of the name of the new queue","For /queue remove, this is the name of the existing queue","CommandParseError","If the user does not have the Bot Admin role.","If a queue with the same name already exists when using /queue add","If /queue remove was invoked in the queue category that the user wants to delete. YABOB will prompt the user to use the command in another text channel."]},{"i":"set_logging_channel","l":"/set_logging_channel","p":["Sets the logging channel on this server. YABOB will start sending log messages to this text channel.","channel- Required Parameter. Which text channel to send logs to.","Bot Admin","CommandParseError","If the user does not have the Bot Admin role.","If the specified channel is being used as a queue channel.","If the specified channel is not a text channel."]},{"i":"stop_logging","l":"/stop_logging","p":["Stops YABOB from sending log messages to this server.","CommandParseError","If the user does not have the Bot Admin role."]},{"i":"set_roles","l":"/set_roles","p":["Sets the access level roles on this server. Namely, controls which roles should be interpreted as , , and .","role_name- Which access level role you want to change. , , or .","role- The role to change to.","CommandParseError","If the user does not have the Bot Admin role.","If the specified role is a bot integration role. These roles can bon"]},{"i":"prompt_help_topic","l":"/prompt_help_topic","p":["This command has 2 subcommands.","/prompt_help_topic on","YABOB will start showing students a modal that asks them what topic do they need help with. Students are not required to submit the modal, and they will still be queued if they don't submit.","This modal is shown when the student uses /enqueue or [Join]","Once the student submits this modal, all helpers of this queue will see:","/prompt_help_topic off","YABOB will not show students the Help Topic modal. Students will be directly enqueued when they use /enqueue or the [Join] button.","CommandParseError","If the user does not have the Bot Admin role."]},{"i":"settings","l":"/settings","p":["Brings up the settings menu. See more details in the Configuration Guide.","CommandParseError","If the user does not have the Bot Admin role."]},{"i":"create_offices","l":"/create_offices","p":["Batch creates voice channels with pre-configured permissions. As of 4.3, voice channels created with this command only allows Bot Admin and Staff to have direct access to the channels. Students can see and join the channels within 15 minutes after they are dequeued.","All 3 options are required.","category_name: The name of the category that holds all the voice channels.","office_name: The prefix of each voice channel.","number_of_offices: How many channels to create","CommandParseError","If the user does not have the Bot Admin role.","If the inputs of category_name or office_name are not valid discord channel names.","If the input of number_of_offices is not a valid integer","Running this command creates the following:"]},{"i":"help","l":"/help","p":["Get help with a command.","command- Required Parameter. The name of the command to get help with. Currently, we are hitting the upper limit of this option so some of the commands are not listed. v4.3.1 will add auto complete to /help to display all the commands.","Student and above.","Nothing."]},{"i":"auto_give_student_role","l":"/auto_give_student_role","p":["This command has 2 sub commands.","/auto_give_student_role on","YABOB will automatically give new members the access level role. The role will be given as soon as new members join the server.","If the @everyone role is the students role, this setting is ignored.","/auto_give_student_role off","YABOB will not automatically give new members the access level role. Students need to be manually assigned this role.","CommandParseError","If the user does not have the Bot Admin role."]},{"l":"Button List","p":["This section covers these buttons:"]},{"i":"join","l":"\uD83D\uDD18 Join","p":["Adds the user to the end of the queue on button click.","CommandParseError","If the #queue channel does not have a parent category.","QueueError","If the student is already in the queue."]},{"i":"leave","l":"\uD83D\uDD18 Leave","p":["Removes the user from the queue on button click.","CommandParseError","If the #queue channel does not have a parent category.","QueueError","If the student not in the queue."]},{"i":"notify-when-open","l":"\uD83D\uDD18 Notify When Open","p":["Adds the user to the notification group for that queue. The user will be automatically removed from the notification group once the queue is open.","CommandParseError","If the #queue channel does not have a parent category.","QueueError","If the user is already in the notification group."]},{"i":"remove-notifications","l":"\uD83D\uDD18 Remove Notifications","p":["Removes the user from the notification group for that queue.","CommandParseError","If the #queue channel does not have a parent category.","QueueError","If the user is not in the notification group."]}],[{"l":"Built-in Extension Commands","p":["Updated Sept.24, 2023"]},{"i":"what-are-yabob-extensions","l":"What are YABOB Extensions?","p":["Since the beginning of YABOB v4.0, we switched over to a new implementation that separates base YABOB and YABOB extensions. This has enabled YABOB to have significantly better performance and allows us to develop new features more quickly.","YABOB extension commands do NOT affect base YABOB's behavior but rather listens for events happening in base YABOB and then shows different information in the #queue channel or in external resources."]},{"l":"Format","p":["The format in all of the following sections will be the same as the Built in Commands page with a new tab, Side Effects,what will happen outside of discord."]},{"i":"session-calendar-extension","l":"\uD83D\uDCC5 Session Calendar Extension","p":["This extension reads from a google calendar you provide and manages the Upcoming Sessions embed inside queue channels to display upcoming office hours sessions. All of the following commands will affect what's being displayed in that embed."]},{"i":"when_next","l":"/when_next","p":["Fetches from the calendar and displays upcoming office hour sessions.","Nothing."]},{"i":"make_calendar_string_all","l":"/make_calendar_string_all","p":["Generates a parsable calendar summary string for ALL the queues this user is approved for. This string needs to be put inside the calendar event's description section for the Upcoming Session embed in each #queue channel to recognize it.","calendar_name Specifies the user's name on the calendar. When this command is run, YABOB remembers the discord id of the user and maps it to calendar_name.","Nothing.","This will return YABOB_START John - class1, class2 YABOB_END if John has the roles class 1 and class 2.","Suppose John's discord handle is @cooljohn123. If John made a google calendar event titled\"Remote office hours for class 1 and class 2\" and put \"Remote\" in the location field, the upcoming session embed will show:","The timeStamp fields are dynamic time strings in discord where you can hover over it and see the literal date and time."]},{"i":"make_calendar_string","l":"/make_calendar_string","p":["Generates a calendar summary string that is guaranteed to be recognized by this extension. This string needs to be put inside the calendar event's description section for the Upcoming Session embed to recognize it.","This command is meant to handle special cases when the staff member doesn't want to include all of their approved queues (Example: They want to host a final review session for only 1 class)","For other use cases, we recommend using /make_calendar_string_all","calendar_name Specifies the user's name on the calendar. When this command is run, YABOB remembers the discord id of the user and maps it to calendar_name","queue_name_1 queue_name_2\\dots queue_name_20 Specifies which queues to be included in this calendar string. The specified queues will then display the calendar event upon refresh.","CommandParseError","If the user does not have the Staff role or the Bot Admin role","If any of the given queues is not a valid queue category","will return YABOB_START John - class1, class2 YABOB_END","After putting this string inside the calendar events, you can press Refresh Upcoming Sessions to refresh the embed. Your name and the calendar title should now appear.","A backup is triggered."]},{"i":"refresh-upcoming-sessions","l":"\uD83D\uDD18 Refresh Upcoming Sessions","p":["Allows the user to manually refresh the calendar embed for 1 queue.","CalendarConnectionError","If the calendar refresh request timed out","If the calendar is not accessible"]},{"i":"google-sheet-logging","l":"\uD83D\uDCCA Google Sheet Logging","p":["This extension logs attendance hours and help session history to a google sheet you provide. For each server, this extension will create 2 google sheet worksheets:"]},{"l":"Your Server Name Attendance Logs","p":["Tracks attendance of each staff member."]},{"i":"column-definitions","l":"**Column Definitions**","p":["The discord username of the helper","The discord id of the helper","When the helper started helping by using /start","When the helper started helping by using /stop","The names of the students that received help","How much time elapsed between /start and /stop in milliseconds.","How much time was the helper actually helping students in a voice channel. This is tracked by recording the time a student stayed in a voice channel.","The total number of students helped, synced with Helped Students."]},{"l":"Your Server Name Help Session Logs","p":["Tracks how many students were being helped on your server."]},{"i":"column-definitions","l":"**Column Definitions**","p":["The student's discord username","The student's discord id","The helper's discord username","The helper's discord id","Time when the student joined the voice channel","Time when the student left the voice channel","Time when the student joined the queue and started waiting.","The queue that the student received help from","How long the student waited before getting dequeued","How long were the student in the voice channel getting help"]},{"i":"stats","l":"/stats","p":["/stats helper","/stats server","Average session time","Average wait time","Error(This will be updated with a different error)","Help sessions","If there's no Help Session Logs worksheet of your server.","Number of student sessions","Returning students","Returns an embed showing the statistic of a helper. The stats include:","Returns an embed showing the statistic of the entire server. The stats are the same as /stats helper.","This command has 2 subcommands:","time_frame Required Parameter. Specifies which time period should the stats come from: All Time, Past Month, or Past Week.","Total available time","Total helping time","Unique students helped"]}],[{"l":"Configure YABOB Settings","p":["Starting with version 4.3, YABOB will post a /settings command to your sever as the entry point for all server related configurations such as:","After session message: The message sent to the students after they finish receiving help","Roles: Which roles should YABOB use as Bot Admin, Staff, and Student","Queue Auto Clear: How long should YABOB wait until all closed queues will be automatically cleared","Logging Channel: Which text channel should YABOB send logs to","Auto Give Student Role: Whether to automatically give new members the @Student Role upon joining the server","Calendar Settings: Which calendar should YABOB read from for the Upcoming Sessions Embed","Google Sheet Settings: Which google sheet should YABOB write attendance logs to","All settings are only available to Bot Admins.","All settings are enabled/disabled for all queues on the server. For example, if queue auto clear is set to 30 minutes, then ALL queues on the server will clear 30 minutes after they close."]},{"i":"server-roles","l":"\uD83D\uDCDD Server Roles","p":["YABOB needs to know which roles to interpret at , , and to enforce the access levels of all the commands. This setting controls which role will be used. We recommend using either one of the \"Use Existing Roles\" option."]},{"i":"use-existing-roles","l":"\uD83D\uDD18 Use Existing Roles","p":["Use existing roles named the same as the missing roles. If not found, create new roles."]},{"i":"use-existing-roles-everyone-is-student","l":"\uD83D\uDD18 Use Existing Roles (@everyone is Student)","p":["Same as Use Existing Roles, but use the @everyone role for the Student role if missing"]},{"i":"create-new-roles","l":"\uD83D\uDD18 Create New Roles","p":["Create brand new roles for the missing roles.","If roles named Bot Admin, Staff, or Student already exist, duplicate roles will be created."]},{"i":"create-new-roles-everyone-is-student","l":"\uD83D\uDD18 Create New Roles (@everyone is Student)","p":["Same as Create New Roles, but use the @everyone role for the Student role if missing"]},{"i":"set_roles-command","l":"/set_roles Command","p":["For more granular control, use the /set_roles command to individually configure the roles."]},{"i":"queue-auto-clear","l":"⏳ Queue Auto Clear","p":["This setting controls whether the queues will automatically clear themselves after closing."]},{"i":"set-auto-clear-time","l":"\uD83D\uDD18 Set Auto Clear Time","p":["Use the modal to put in the number of hours and minutes to wait before clearing a closed queue. For example, if auto clear is set to 9h 0min, then after the queue becomes closed, everyone that's still in the queue will be cleared in 9 hours.","Maximum timeout is 100 hours and 39 minutes. (If 99 hours 99 minutes is entered into the textbox)","If there's a running timer when this command is used, the old timer will be discarded and a new timer with the new timeout will be started.","Queue channels will also display the timer:"]},{"i":"-logging-channel","l":"\uD83E\uDEB5 Logging Channel","p":["This setting controls which channel should YABOB send logging messages to. The logs will look like the following:","All command usages, button presses, and errors will be sent to this channel."]},{"i":"after-session-message","l":"\uD83D\uDCE8 After Session Message","p":["Sometimes it could be useful to automatically send a message to the students after they finish receiving help, such as asking for feedbacks. Here's an example message:"]},{"i":"set-after-session-message","l":"\uD83D\uDD18 Set After Session Message","p":["Use the modal to input the after session message. All discord markdown syntax is supported. You can check which markdown rules are supported on discord here"]},{"i":"auto-give-student-role","l":"\uD83C\uDF93 Auto Give Student Role","p":["Manually assigning the student role to new members could be tedious. This setting configures whether YABOB should automatically give the student role to new members when they join the server."]},{"i":"enable","l":"\uD83D\uDD18 Enable","p":["YABOB will automatically give new members the role as soon as they join the server. You can always check which role is on your server by going to the Server Roles setting."]},{"i":"disable","l":"\uD83D\uDD18 Disable","p":["YABOB will not add roles to new members."]},{"i":"calendar-settings","l":"\uD83D\uDCC5 Calendar Settings","p":["Changes the calendar this server reads from for office hour events."]},{"i":"change-calendar-settings","l":"\uD83D\uDD18 Change Calendar Settings","p":["Once clicked, a form will pop up asking for a calendar ID and an optional public embed URL."]},{"l":"How to find this calendar ID","p":["Open Google Calendar, click the 3 dots on the calendar that you want to use \\to click Settings and Sharing.","Click Make available to public","Scroll down to Integrate Calendar and copy the string under Calendar ID. This is the id string of your calendar","Fill the calendar id field with this id.","If the public embed url is unspecified, the [Full Calendar] button in all the #queue channels will take users to the default google calendar embed, which looks like the following:","If you wish to have a different calendar website than the default google calendar embed, fill in the public embed URL as well (URL must be complete, i.e include https).","YABOB cannot check if this URL is safe for users to click on, so it is the server owner's responsibility to ensure the link is safe."]},{"i":"help-topic-prompt","l":"\uD83D\uDE4B Help Topic Prompt","p":["Controls whether to show students a modal asking for a help topic. This is useful if helpers wishes to know what the students in the queue need help with before they join the voice channel."]},{"i":"enable","l":"\uD83D\uDD18 Enable","p":["YABOB will start showing students a modal that asks them what topic do they need help with. Students are not required to submit the modal (they can dismiss it by closing it or clicking Dismiss), and they will still be queued if they don't submit.","This modal is shown when the student uses /enqueue or click [Join].","Once the student submits this modal, all helpers of this queue will see:"]},{"i":"disable","l":"\uD83D\uDD18 Disable","p":["YABOB will not show students the Help Topic modal. Students will be directly enqueued when they use /enqueue or the [Join] button."]},{"i":"serious-mode","l":"\uD83E\uDDD0 Serious Mode","p":["Controls whether to show \"fun stuff\" like emojis in queue channels."]},{"i":"enable","l":"\uD83D\uDD18 Enable","p":["Removes all emotions and the hidden cat from the queues"]},{"i":"disable","l":"\uD83D\uDD18 Disable","p":["Enables all emotions and the hidden cat from the queues"]},{"i":"google-sheet-settings","l":"\uD83D\uDCCA Google Sheet Settings","p":["Controls which Google Sheet this server will be used for logging."]},{"i":"change-google-sheet","l":"\uD83D\uDD18 Change Google Sheet","p":["Use this button to change which google sheet to use for logging helper hours. Clicking this button will prompt a modal asking for a google sheet ID."]},{"l":"How to find this google sheet id","p":["A google sheet's URL looks like this:","The string after d/ and before /edit is your google sheet id."]},{"l":"Before you click submit","p":["Make sure the google sheet is shared with the YABOB in your server and YABOB has EDIT permission. You can find YABOB's email in the google sheet settings menu.","You can always revoke the permission by removing yabob from the list of accounts with access or reset to the default google sheet.","GoogleSheetConnectionError","If this google sheet is not accessible. This can happen if you did not share the google sheet with the YABOB inside your server. Don't worry, YABOB will tell you what its email address is when this error happens.","No immediate side effect. The next log will be written to this new google sheet."]},{"i":"reset-google-sheet","l":"\uD83D\uDD18 Reset Google Sheet","p":["Clicking this button will tell YABOB to use the default (public) google sheet for logging tutor hours. We recommend not using this default sheet for production environment since it's public."]}],[{"l":"Developer Setup Guide"},{"l":"System Requirements","p":["Install Node.js, select the Long Term Support version."]},{"l":"Before we start","p":["For the rest of this guide, we will assume that you are setting up for development use. For production:","Fill in YABOB/src/environment/production.json instead of YABOB/src/environment/development.json","The run command is npm run prod instead of npm run dev","Use npm install --production to skip installing dev dependencies"]},{"i":"step-1-discord-developer-account-bob-app-id","l":"Step 1. Discord Developer Account, BOB App ID","p":["Make a discord server.","Follow Discord's Official Documentation and create a bot account. For the bot permissions at step 6, choose Administrator.","Look for APPLICATION ID in the General Information tab. This is your YABOB_APP_ID.","Look for TOKEN in the Bot tab (it has a reset token button next to it). This is your YABOB_BOT_TOKEN.","In the Bot tab under Privileged Gateway Intents, enable SERVER MEMBERS INTENT.","In the OAuth2 \\to URL Generator tab, select bot in scopes, then select Administrator in bot permissions. Finally copy the generated URL at the bottom and paste it in your browser.","Opening the link will prompt you to invite your YABOB instance! Simply choose the server that you want to invite YABOB to.","If you are inviting YABOB to a server with existing roles, YABOB will prompt you to give it the highest role. Once you have saved the role settings, YABOB will DM you again saying that it got the highest role. Make sure that YABOB's role name is the same as YABOB's username."]},{"l":"Clone the source code","p":["For simplicity we'll be referring to the project's root directory as YABOB for the rest of this page."]},{"l":"Step 2. Setup Firebase","p":["Go to Google Firebase Console and sign in with a google account.","Click CREATE A PROJECT and follow the guide.","One the left \\to All products \\to Cloud Firestore, create a new database. Wait for it to finish.","One the left, Settings \\to Project Settings \\to Service Accounts \\to Generate New Private Key. This will prompt you to download a JSON file.","Go to YABOB/src/environment/production.json","From the file you just downloaded:","Put the value of project_id into projectId","Put the value of private_key into privateKey","Put the value of client_email into clientEmail"]},{"l":"Step 3. Running YABOB without extensions","p":["Go to YABOB/src/environment/production.json, fill in:","For example:","Install all the dependencies:","Now you can run the bot with the fundamental functionalities using this command: ( Don't forget the space between the 2 dashes and noExtensions)"]},{"i":"step-4-setting-up-extensions-optional","l":"Step 4. Setting up extensions (optional)","p":["Right now you have a functioning YABOB! To make YABOB more useful and customizable, we developed the extensions feature in v4. YABOB comes with 2 built in extensions:","Google Sheet Logging","Utilizes Google Sheets to track tutor/helper attendance and make sure they are following their schedules, as well as providing insights to how many help sessions are being held.","Session Calendar","Utilizes Google Calendar to display upcoming help sessions in the queue so that students can easily see when the next office hour session will happen."]},{"l":"Ignoring Credentials in Git","p":["For development, run this command in the YABOB directory:","This will ignore all changes in the credentials json files so they aren't accidentally pushed to the repository.","If the file structure changes in the future and requires new commits, run this:","and git will track these files again. Ignore the changes again after updates."]},{"l":"Google Sheet Logging Extension Requirements"},{"l":"Service Account Key","p":["Go to Google Cloud and add your google account of choice.","Click Select a Project on the top left and create a new project.","Then go to API & Services \\to Credentials tab \\to Create Credentials \\to Service Account.","Follow the guide to create a service account. Enable Owner Permission.","Once you are back at the Credentials tab, click on the account you just created \\to KEYS \\to Add Key: Create New Key \\to Choose JSON \\to It will prompt you to download your key.","Copy the corresponding values of this JSON file into YABOB/src/environment/development.json.","This client_email is the email of YABOB. We will share the google sheet with this email in the next step."]},{"l":"Google Sheets API","p":["Still in the Google Cloud Console, go to APIs and Services \\to Enabled APIs & Services.","Click on ENABLE APIS AND SERVICES.","Search for Google Sheets, Click on that then click ENABLE.","Search for Google Drive, enable this API as well.","Now we have access to google sheets, we just need the sheet itself."]},{"l":"Google Sheets ID","p":["Create an empty Google Sheet and share the sheet to YABOB's service account email with EDIT access.","This is the client_email field under googleCloudCredentials","The google sheets URL looks like this:","That very long string is your YABOB_GOOGLE_SHEET_ID.","Go to YABOB/src/environment/development.json. Fill in YABOB_GOOGLE_SHEET_ID with the string you just found."]},{"l":"Calendar Extension Requirements"},{"l":"Google Calendar API","p":["Create a google calendar.","Go to that particular calendar's Settings and Sharing tab. Tick the Make available to public checkbox.","Scrolling down will take you do the Integrate Calendar Section. Copy the Calendar ID. It should end with calendar.google.com. This is your YABOB_DEFAULT_CALENDAR_ID and will be used as a fallback calendar","Go to Google Cloud, then go to APIs and Services \\to Enabled APIs & Services","Enable the Calendar API","Still in APIs and Services, go to Credentials\\to CREATE CREDENTIALS: API KEY","Now you will be prompted with a long string. You can limit the scopes of this key by following the guide on screen. This is your YABOB_GOOGLE_API_KEY","Go to YABOB/src/environment/development.json, fill in"]},{"l":"Final Check","p":["Everything in YABOB/src/environment/development.json should now have a value instead of an empty string."]},{"l":"Step 5. Running with Extensions","p":["Remove the -- noExtension flag from step 2."]}],[{"l":"Writing Extensions","p":["Updated on Jan. 10, 2022","This page applies to YABOB v4.3 and above"]},{"i":"so-you-want-to-build-your-own-extensions","l":"So you want to build your own extensions...","p":["That's great! YABOB V4 is designed to be customizable and extensible. So we provided the following 3 levels of extensions interfaces.","Interaction Level","Server Level","Queue Level","Server and Queue extensions will be able to get data from the base YABOB using the Observer Pattern. Interaction level extension can add custom commands/buttons allowing users to interact with your extensions.","The 3 levels never directly interact with each other by design. If your extension spreads across all 3 levels, you should also create a shared state class.","Everything in the following interfaces are optional. Make sure your extension inherit from the concrete base classes described below. (unless your extension implements the entire interface)"]},{"l":"Parameters","p":["The FrozenServer, FrozenQueue, FrozenDisplay interfaces removes all the methods that should not be accessed and marks everything else readonly."]},{"l":"Server Level Extensions","p":["These extensions are loaded when an instance of AttendingServerV2 is created.","Your extension need to inherit from the concrete BaseServerExtension class"]},{"l":"Loading Server Extensions","p":["In the AttendingServerV2.create() method, find this line:","Then add the constructor / async create method."]},{"l":"Server Events"},{"l":"onServerInitSuccess","p":["Called when an AttendingServerV2 is successfully created."]},{"l":"onAllQueueInit","p":["Called when all the queues inside the server are done rendering and ready to go."]},{"l":"onQueueDelete","p":["When a queue gets deleted using the /queue remove (queue_name) command"]},{"l":"onDequeueFirst","p":["When a student is dequeued by a helper using the /next command."]},{"l":"onHelperStartHelping","p":["When a helper uses /start"]},{"l":"onHelperStopHelping","p":["When a helper uses /stop"]},{"l":"loadExternalServerData","p":["Called on inside AttendingServerV2.create(). Currently, the server will load the first backup provided by any extension. You can also alter this behavior by changing how this function is called inside AttendingServerV2.create()."]},{"l":"onStudentJoinVC","p":["Called when a student joins VC through the invite sent after a helper uses /next. A voice channel object is guaranteed to exist."]},{"l":"onStudentLeaveVC","p":["Called when a student leaves VC after joining with the invite sent after a helper uses /next."]},{"l":"onServerDelete","p":["Called when YABOB is kicked from a server. If your extension maintains an internal state in memory, this is the time to run any necessary cleanup."]},{"l":"Queue Level Extensions","p":["These extensions are loaded when an instance of HelpQueueV2 is created.","Your extension need to inherit from the concrete BaseQueueExtension class"]},{"l":"Loading Queue Extensions","p":["In the HelpQueueV2.create() method, find this line:","Then add the constructor / async create method."]},{"l":"Sending your own embeds","p":["If you would like your extension to have a custom embed inside a #queue channel, make sure to:","Accepts a readonly renderIndex in the extension's constructor or asynchronous create method.","This is assigned to each extension during queue create. With this index, QueueDisplayV2 will help make sure that all embeds are correctly rendered.","If any embed gets accidentally deleted and a queue render was triggered, QueueDisplayV2 will try to re-render the queue embed and extension embeds using the rendering method your extensions provide.","If your embed will re-render WITH the queue, override the onQueueRender method and call display.requestNonQueueEmbedRender to send your embed","If your embed will NOT render with the queue, accept the queue display as a parameter in the extension constructor or the async create method and hold on to the display object and mark it as readonly. Then when you are ready to send the embeds, call display.requestNonQueueEmbedRender"]},{"l":"Queue Events"},{"l":"onQueueCreate","p":["Called when a queue is successfully created, meaning all renderings are complete."]},{"l":"onQueueOpen","p":["Called when a queue is successfully opened."]},{"l":"onQueueClose","p":["Called when a queue is successfully closed."]},{"l":"onEnqueue","p":["When a student joins the queue."]},{"l":"onDequeue","p":["When the 1st student is dequeued."]},{"l":"onStudentRemove","p":["When a students is removed from the queue. Happens when a student chooses to leave the queue using /leave or the Leave Button."]},{"l":"onRemoveAllStudents","p":["When everyone in the queue is removed. Happens when a helper uses /clear (queue). This will not trigger onStudentRemove()."]},{"l":"onQueueRender","p":["Called when the queue embed starts to re-render."]},{"i":"onqueuedelete-1","l":"onQueueDelete","p":["Called when a queue is using gracefulDelete, which is triggered by /queue remove (as of right now). If your queue extension maintains an internal state in memory, this is the time to run any necessary clean up procedure."]},{"l":"Interaction Level Extensions","p":["This is a special type of extension. Loaded in the joinGuild method in app.ts.","Your extension need to inherit from the concrete BaseInteractionExtension class"]},{"l":"Loading Interaction Extensions","p":["In interaction-entry-point.ts, find this line:","Then add your extension in the array. The creation method must be through a constructor."]},{"l":"Method Maps","p":["Your extension need to maintain at least 1 of the following:","commandMap","buttonMap","selectMenuMap","modalMap","where the keys are the names of your command's commandName or the names that are encoded into setCustomId. The values are handler functions that will respond to the interaction. Your method maps will be combined with the base YABOB's method map once YABOB starts."]},{"l":"slashCommandData","p":["These are the objects from SlashCommandBuilder.toJSON(). On start up, app.ts will post your commands along with all the built in commands to your discord servers. Make sure your command names does NOT overlap with any of the built in ones, otherwise Discord API will refuse to post any command.","The built in ones can be found in the Built-in Commands page."]},{"l":"Accessing External Data in Extensions","p":["Extensions at each level are launched with Promise.all() meaning that extensions that listen to the same event will be started synchronously and YABOB will wait for the last one to finish. To avoid race conditions, we recommend extensions that listen to the same event to NOT WRITE TO the SAME data source."]},{"i":"extensions-with-multiple-levels-managing-internal-state","l":"Extensions with Multiple Levels, Managing Internal State","p":["Since the 3 levels of extensions don't directly interact with each other, you will need a state object that acts as a mediator","session-calendar_diagram","When the queue level extensions are loaded, they will push themselves into the serverIdCalendarStateMap.listeners hashmap.","The command level extension is only responsible for processing the commands, then write to calendarExtensionConfig or update the calendarNameDiscordIdMap. After the command extension is done updating the state, it will call onCalendarExtensionStateChange() for each listener in the listeners map. This is a catch-all event for this particular extension, but you can always add more sophisticated ones!","The queue level extension is only responsible for grabbing events based on the calendar id in calendar-config.json then producing the embed based on the calendar title and the contents in calendarNameDiscordIdMap.","The CalendarServerEventListener class listens for the server delete event and cleans up the serverIdCalendarStateMap for this server.","These 2 levels are loosely coupled with each other. Command level will not directly affect queue-level's behavior, but they share the calendar id and calendarNameDiscordIdMap as an internal state.","None of the other extensions will see or interfere with this state."]}],[{"l":"How to run YABOB on a Cloud Server","p":["For this guide, we are going to be using AWS cloud servers. If for some reason you choose not to use AWS, the steps should be the same for any other cloud server apart from how to instantiate a server"]},{"i":"part-0-set-up","l":"Part 0: Set up","p":["Pre-req: Development Setup Guide","This guide assumes you have a decent grasp of the linux command line and file system. All commands are for linux based systems, i.e. probably won't work for windows cmd.","We highly recommend you to create a parent directory (aka folder) for the YABOB repo. We will be dealing with permission keys and ip addresses so it's safer to store them outside the git repo so that you never accidently commit sensitive info to the github repo.","The rest of the guide assumes you have set up a parent directory. For the rest of this guide, lets say the YABOB directory (which is connected to the github repo) is inside of another directory called YABOB-super"]},{"i":"part-1-creating-an-aws-ec2-server","l":"Part 1: Creating an AWS EC2 Server"},{"l":"Creating an AWS Account","p":["TODO"]},{"l":"Navigating the AWS Dashboard","p":["TODO"]},{"l":"Instantiating a new EC2 server","p":["TODO","For now reference the offical documentation: https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/setting-up-node-on-ec2-instance.html to create a new EC2 instance. Create an Ubuntu server instance, and if possible use the LTS. Make sure to use the free tier","Keep the private key in the YABOB-super directory and rename it to something of your choosing. For this guide we named the private key permission file as YABOB-AWS-PRIVATE-KEY.pem.","Also note down the IPv4 address of your EC2 instance. We will be refering to the address as A.B.C.D typically as ubuntu@A.B.C.D","If it's the account's EC2 instance you will get 1 year free trial. After that money will be automatically deducted from your account unless you set up prevention measures before. If you have disable billing, at the end of your free trial, you will lose access to the EC2 server instance you've created."]},{"i":"part-2-connecting-to-an-aws-ec2-server","l":"Part 2: Connecting to an AWS EC2 Server","p":["The following ssh command will give you remote access to the EC2 server instance you created","After executing this command, you should now be inside the server. Try out some basic commands like mkdir and cd to get a feel of the system structure.","To return back to your local computer on the terminal, type the following command while in the EC2 server:"]},{"i":"part-3-how-to-transfer-files-to-and-from-your-ec2-instance","l":"Part 3: How to transfer files to (and from) your EC2 instance"},{"i":"preface-the-scp-command-skip-if-you-know-what-this-does","l":"Preface: The scp command (skip if you know what this does)","p":["To copy a file from your computer to a server through ssh, the command is:","e.g. lets say we are in the directory where the file abc.xyz is located and we want to transfer this file to the EC2 at the directory ~/qwerty. The command would be as follows","Try this out yourself!","The process for copying a file from the server to your local computer is similar and simply requires you to specify the server path first and then the local path","e.g. Lets do the opposite of the previous example. Let's copy the file in the server whose path is ~/qwerty/abc.xyz to the current directory","If you try to copy over an entire directory using the either of the previous formats, you'll notice that the command line gives you an error saying you can't copy a directory. To resolve this issue, we need to specify the -r option so that the kernel knows to recursively call the copy command on any children of files that you specify.","e.g.:"]},{"l":"Copying the YABOB repo to EC2","p":["In theory, with the above knowledge, all we need to do to run YABOB on the EC2 server is to copy over the entire directory and then run the npm run prod command there. If you try to simply run:","it will take a very long time. This is because you are also copying the node_modules folder which is very large in both size and number of files. It will also be trying to copy over git files which is unnecessary.","Instead, lets just copy over the necessary files. We chose the following since these are the only files required to compile and run the bot:","NOTE: if in the future, you are unable to compile the bot on the EC2 instance due to RAM limitations do the following:","Compile the node project locally","Copy over the YABOB/dist folder instead of YABOB/src and YABOB/help-channel-messages(The following steps are in reference to the next section)","In the EC2 instance run npm install","Use npm run dev_precompiled or npm run prod_precompiled to run the project instead of npm run dev or npm run prod","Use the following template to create a file called copy_files.sh in YABOB-super. Replace A.B.C.D with your server ip address and modify the name of the permission file if you've saved it as something else","AVOID STORING THIS FILE INSIDE THE YABOB FOLDER SINCE YOU MAY ACCIDENTLY COMMIT SENSITIVE INFO TO THE REPO","To run the shell file:","NOTE: the kernel may tell you that you don't have permission to execute the copy_files.sh file. This is because all .sh files are usually unexecutable by default. To enable the file to be executable, run:"]},{"i":"part-4-running-a-nodejs-app-on-ec2","l":"Part 4: Running a node.js app on EC2"},{"i":"installing-and-using-the-correct-version-of-nodejs","l":"Installing and using the correct version of node.js","p":["First check if node.js is alreayd installed in the server by running:","If present and it's a version less than 18.12.0, then use nvm to install and change to the latest version:","If node and/or nvm is not present, refer to the offical AWS documentation to install node.js and nvm on EC2"]},{"l":"Running the project","p":["Once you have the right node version installed, enter into the YABOB folder","Then do npm install to install all the dependancies","NOTE: If npm install tells you there are vulnerabilities, run npm audit fix like it tells you to do fix the issue. If npm audit fix doesn't resolve all the vulnerabilities after multiple attempts, it is recommended that you try to resolve them manually, espeically if they're severe vulnerabilities","Finally to run the project, do"]},{"i":"part-5-using-pm2-to-run-a-process-indefinetly-on-ec2-even-when-not-remote-accessing-it","l":"Part 5: Using PM2 to run a process indefinetly on EC2 even when not remote accessing it","p":["If you exit the server connection after doing npm run dev, even if you move the process to background, it's most likely going to stop running. To resolve this issue we will use pm2 which allows us to run a process on a server even when we aren't remote accessing it. Another useful feature of pm2 is that it will automatically restart the process if the process were to crash","Install pm2 globally:","The general template to run a process in pm2 is as follows:","for YABOB, we have the additional issue of having the process depend on environment variables. We solve this issue by defining the environmental variables before calling pm2:","Luckily for you, we consolidated the compilation and using pm2 to run the bot in the npm run prod command! So all you need to do is:","NOTE: It is not necessary to run pm2 start in the folder of the project, but we are doing so since we have environment variables. Also so that we can simply run npm run prod","And now you're done! YABOB is now running on pm2! Exit the ssh session and double check that YABOB is still running"]},{"i":"some-useful-commands-for-pm2","l":"Some useful commands for pm2:","p":["Viewing processes that pm2 is running:","[Insert example image later]","To stop a process with id 'X' (which will be a number):","To remove a process from pm2:"]},{"i":"part-6-accessing-logs","l":"Part 6: Accessing Logs","p":["Since you're running YABOB on pm2, the logs are not being printed out to the terminal. To access the logs,","Use this to see stdout (normal) logs:","Use this to see stderr (error) logs:","If you don't want to connect to the server to view the logs, use scp to copy over the log files to your local computer:","This will create a new folder in YABOB-super with the name logs which will contain the log files","NOTE: if you are running multiple processes on pm2, all of the logs are combined into the same file, each for stdout and stderr. I.e., you will view a mix of logs from different processes when viewing pm2 logs"]}]]